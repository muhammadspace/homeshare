# REST API Endpoints
## POST
| **Endpoint**                         | **Description**                                                                                                | **Request Body**                                                                                                                                                                                                                                                                                                                                                                      | **Response**                                                                                                             | **Authorization required** | **Notes**                                                                                                                                                          |
| ------------------------------------ | -------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------ | :------------------------: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `/login`                             |                                                                                                                | `email` and `password`                                                                                                                                                                                                                                                                                                                                                                | `{ status: true/false, success: success/failure message }`                                                               |                            |                                                                                                                                                                    |
| `/registration`                      |                                                                                                                | `username`, `email`, `password`, `picture`, `dob`, `job`, `type`, `hobbies_pastimes`, `sports_activities`, `cultural_artistic`, `intellectual_academic`, `personality_trait`, `value_belief`, `interpersonal_skill`, `work_ethic`, `gender`                                                                                                                                           | `{ success: boolean, message: success/error message string }`                                                            |                            | If registering as admin, the email address must end with @fci.helwan.edu.eg and you only need to provide username, email, and password and set the type to "admin" |
| `/profile`                           | Update the logged-in user's information                                                                        | The fields to update and their new values                                                                                                                                                                                                                                                                                                                                             |                                                                                                                          |             ✔              |                                                                                                                                                                    |
| `/invite`                            | Generates an invite                                                                                            | `to`: recepient ID, `from`: sender ID, `apt`: apartment ID                                                                                                                                                                                                                                                                                                                            | Same as in request body, but also includes `id`: the newly created invite's ID, `rejected`: boolean, `accepted`: boolean |                            |                                                                                                                                                                    |
| `/invite/:inviteid/<accept/reject>`  | Accept or reject the invite with ID `inviteid`                                                                 |                                                                                                                                                                                                                                                                                                                                                                                       | `success`: boolean, `message`                                                                                            |             ✔              |                                                                                                                                                                    |
| `/apt`                               | Create a new apartment and make it pending approval by admins                                                  | `location`, `owner`, `max`, `price`, `bedrooms`, `bathrooms`, `property_type`, `start_date`, `end_date`, `residents`: (optional) array of IDs of current residents, `invites`: (optional) array of IDs of invites to this apartment, `contract`: url of a picture of the contract, `admin_approval`: a string that needs to be one of three choices: "pending", "approved, "rejected" | Same as request body but includes `id`: newly created apt's ID,                                                          |                            |                                                                                                                                                                    |
| `/apt/join/:aptid`                   | Adds the logged-in user to apartment with id `aptid`                                                           |                                                                                                                                                                                                                                                                                                                                                                                       |                                                                                                                          |             ✔              | If the number of residents in the apartment is not less than the apartment's `max` the user won't be able to join the aparmtent.                                   |
| `/apt/kick`                          | Removes a resident from the apartment                                                                          | `resident`: id, `apt`: id                                                                                                                                                                                                                                                                                                                                                             | `{ success: boolean, message: string }`                                                                                  |             ✔              | The token of the owner of th apartment must be included                                                                                                            |
| `/flask/recommend/owners_interests`  | Recommends owners to a seeker based on interests                                                               | `seeker_id`: id of the seeker                                                                                                                                                                                                                                                                                                                                                         | JSON array of `{ "apt": id, "common_interests": number of common interests, "owner_id": id}`                             |                            |                                                                                                                                                                    |
| `/flask/recommend/seekers_interests` | Recommends seekers to an owner based on interests                                                              | `owner_id`: id of the owner                                                                                                                                                                                                                                                                                                                                                           | JSON array of `{ "similarity": percentage (decimal), "common_interests": number of common interests, "seeker_id": id}}`  |                            |                                                                                                                                                                    |
| `/flask/recommend/owners_traits`     | Recommends owners to a seeker based on traits                                                                  | `seeker_id`: id of the seeker                                                                                                                                                                                                                                                                                                                                                         | JSON array of `{ "apt": id, "common_interests": number of common interests, "owner_id": id}`                             |                            |                                                                                                                                                                    |
| `/flask/recommend/seekers_traits`    | Recommends seekers to an owner based on traits                                                                 | `owner_id`: id of the owner                                                                                                                                                                                                                                                                                                                                                           | JSON array of `{ "similarity": percentage (decimal), "common_interests": number of common interests, "seeker_id": id}}`  |                            |                                                                                                                                                                    |
| `/admin/apt/approve`                 | If logged in as an admin, approve an apartment by its id                                                       | `aptid`: apartmnet id                                                                                                                                                                                                                                                                                                                                                                 | `{ success: boolean, message: success/error message string }`                                                            |             ✔              |                                                                                                                                                                    |
| `/admin/apt/reject`                  | If logged in as an admin, reject an apartment by its id, and also remove it from the owner's `owned_apt` field | `aptid`: apartmnet id                                                                                                                                                                                                                                                                                                                                                                 | `{ success: boolean, message: success/error message string }`                                                            |             ✔              |                                                                                                                                                                    |
| `/admin/apt/pending`                 | Get apartments that are pending admin approval                                                                 |                                                                                                                                                                                                                                                                                                                                                                                       | JSON array of `apt` objects                                                                                              |             ✔              |                                                                                                                                                                    |
| `/chat`                              | Send a message to the chatbot and get a response                                                               | `message`: the message to send to the chatbot                                                                                                                                                                                                                                                                                                                                         | `response`: the chatbot's response                                                                                       |                            |                                                                                                                                                                    |
---
<br>

## GET
| **Endpoint**                | **Description**                               | **Request Body** | **Response**                                                                                                                                                                                                                                                                 | **Authorization required** | **Notes** |
| --------------------------- | --------------------------------------------- | ---------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------------------: | --------- |
| `/invite/:inviteid`         | Gets information of invite with ID `inviteid` |                  | `invite_id`: invite ID, `to`: recepient ID, `from`: sender ID, `apt`: apartment ID, `rejeceted`: boolean, `accepted`: boolean                                                                                                                                                |             ✔              |           |
| `/user/:id`                 | Gets information of user                      |                  | `username`, `picture`, `dob`, `job`, `gender`, `type`, `hobbies_pastimes`, `sports_activities`, `cultural_artistic`, `intellectual_academic`, `intellectual_academic`, `personality_trait`, `value_belief`, `interpersonal_skill`, `work_ethic`, `owned_apt`, `resident_apt` |                            |           |
| `/apt/<apt id or owner id>` | Gets information of apartment with `aptid`    |                  |                                                                                                                                                                                                                                                                              |                            |           |
| `/admin/clusters`           | Gets customer clusters                        |                  | `clusters`: an array of ints where each int is the count of customers in a cluster                                                                                                                                                                                           |             ✔              |           |

---
<br>

# TODO
- [x] implement user update endpoint
- [x] implement user get information endpoint
- [x] fix the Flask implementation of seeker recommendations such that it includes `apts` | EDIT: if each owner can only own one apartment, then this is easily fixed by returning the apt id instead of an array.
- [x] replace the local datasets with MongoDB 
- [x] implement jwt token authorization for invites
- [x] remove `furnished` field from apts
- [x] based on the questions below, refactor the owned_apts field so that it's not an array

# Questions
- Are owners considered residents of the apartments they own?
- Can one owner have more than one apartment?
- Is an owner just a seeker who already lives in an apartment?